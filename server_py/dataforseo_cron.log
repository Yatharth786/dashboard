2025-10-24 10:12:10,600 - INFO - 
======================================================================
2025-10-24 10:12:10,600 - INFO - [START] STARTING DATA COLLECTION
2025-10-24 10:12:10,601 - INFO - [INFO] Keywords: laptop, smartphone, headphones, smartwatch, tablet
2025-10-24 10:12:10,601 - INFO - [INFO] Started at: 2025-10-24 10:12:10.601227
2025-10-24 10:12:10,601 - INFO - ======================================================================

2025-10-24 10:12:10,601 - INFO - [ATTEMPT 1/3] Connecting to database...
2025-10-24 10:12:20,616 - ERROR - [FAILED] Database connection attempt 1/3: connection to server at "122.176.108.253", port 5432 failed: timeout expired

2025-10-24 10:12:20,620 - INFO - [RETRY] Waiting 2 seconds before retry...
2025-10-24 10:12:22,620 - INFO - [ATTEMPT 2/3] Connecting to database...
2025-10-24 10:12:32,626 - ERROR - [FAILED] Database connection attempt 2/3: connection to server at "122.176.108.253", port 5432 failed: timeout expired

2025-10-24 10:12:32,627 - INFO - [RETRY] Waiting 4 seconds before retry...
2025-10-24 10:12:36,627 - INFO - [ATTEMPT 3/3] Connecting to database...
2025-10-24 10:12:46,631 - ERROR - [FAILED] Database connection attempt 3/3: connection to server at "122.176.108.253", port 5432 failed: timeout expired

2025-10-24 10:12:46,632 - ERROR - [ERROR] All database connection attempts failed
2025-10-24 10:12:46,632 - ERROR - Please check:
2025-10-24 10:12:46,632 - ERROR -   1. Database server is running and accessible
2025-10-24 10:12:46,632 - ERROR -   2. Firewall allows connections on port 5432
2025-10-24 10:12:46,632 - ERROR -   3. Database credentials are correct
2025-10-24 10:12:46,632 - ERROR -   4. Network connectivity to database server
2025-10-24 10:12:46,632 - ERROR - [FATAL] Cannot proceed without database connection
2025-10-24 10:26:58,055 - INFO - 
======================================================================
2025-10-24 10:26:58,056 - INFO - [START] STARTING DATA COLLECTION
2025-10-24 10:26:58,056 - INFO - [INFO] Keywords: laptop, smartphone, headphones, smartwatch, tablet
2025-10-24 10:26:58,056 - INFO - [INFO] Started at: 2025-10-24 10:26:58.056324
2025-10-24 10:26:58,056 - INFO - ======================================================================

2025-10-24 10:26:58,056 - INFO - [ATTEMPT 1/3] Connecting to database...
2025-10-24 10:26:58,164 - INFO - [SUCCESS] Database connected
2025-10-24 10:26:58,254 - INFO - [SUCCESS] Database tables ready
2025-10-24 10:26:58,254 - INFO - ======================================================================
2025-10-24 10:26:58,255 - INFO - [START] Collecting: laptop
2025-10-24 10:26:58,255 - INFO - ======================================================================
2025-10-24 10:26:58,256 - INFO - [SUBMIT] Submitting task: laptop
2025-10-24 10:26:59,145 - INFO - [SUCCESS] Task submitted: 10240756-1177-0209-0000-1342f4c57f6b
2025-10-24 10:26:59,193 - INFO - [SAVED] Task saved: 10240756-1177-0209-0000-1342f4c57f6b
2025-10-24 10:26:59,193 - INFO - [WAIT] Waiting 90 seconds for processing...
2025-10-24 10:28:29,212 - ERROR - [ERROR] API request failed: HTTPSConnectionPool(host='api.dataforseo.com', port=443): Max retries exceeded with url: /v3/merchant/amazon/products/task_get/advanced/10240756-1177-0209-0000-1342f4c57f6b (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x00000268EA87D6D0>: Failed to resolve 'api.dataforseo.com' ([Errno 11001] getaddrinfo failed)"))
2025-10-24 10:28:29,213 - ERROR - [ERROR] Failed to get results for: 10240756-1177-0209-0000-1342f4c57f6b
2025-10-24 10:28:29,215 - INFO - ======================================================================
2025-10-24 10:28:29,219 - INFO - [START] Collecting: smartphone
2025-10-24 10:28:29,219 - INFO - ======================================================================
2025-10-24 10:28:29,223 - INFO - [SUBMIT] Submitting task: smartphone
2025-10-24 10:28:29,253 - ERROR - [ERROR] API request failed: HTTPSConnectionPool(host='api.dataforseo.com', port=443): Max retries exceeded with url: /v3/merchant/amazon/products/task_post (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x00000268EA87DA90>: Failed to resolve 'api.dataforseo.com' ([Errno 11001] getaddrinfo failed)"))
2025-10-24 10:28:29,259 - ERROR - [ERROR] Task submission failed: No response
2025-10-24 10:28:29,262 - INFO - ======================================================================
2025-10-24 10:28:29,266 - INFO - [START] Collecting: headphones
2025-10-24 10:28:29,271 - INFO - ======================================================================
2025-10-24 10:28:29,294 - INFO - [SUBMIT] Submitting task: headphones
2025-10-24 10:28:29,307 - ERROR - [ERROR] API request failed: HTTPSConnectionPool(host='api.dataforseo.com', port=443): Max retries exceeded with url: /v3/merchant/amazon/products/task_post (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x00000268EA87E350>: Failed to resolve 'api.dataforseo.com' ([Errno 11001] getaddrinfo failed)"))
2025-10-24 10:28:29,310 - ERROR - [ERROR] Task submission failed: No response
2025-10-24 10:28:29,313 - INFO - ======================================================================
2025-10-24 10:28:29,314 - INFO - [START] Collecting: smartwatch
2025-10-24 10:28:29,319 - INFO - ======================================================================
2025-10-24 10:28:29,326 - INFO - [SUBMIT] Submitting task: smartwatch
2025-10-24 10:28:29,339 - ERROR - [ERROR] API request failed: HTTPSConnectionPool(host='api.dataforseo.com', port=443): Max retries exceeded with url: /v3/merchant/amazon/products/task_post (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x00000268EA87E710>: Failed to resolve 'api.dataforseo.com' ([Errno 11001] getaddrinfo failed)"))
2025-10-24 10:28:29,339 - ERROR - [ERROR] Task submission failed: No response
2025-10-24 10:28:29,344 - INFO - ======================================================================
2025-10-24 10:28:29,349 - INFO - [START] Collecting: tablet
2025-10-24 10:28:29,354 - INFO - ======================================================================
2025-10-24 10:28:29,365 - INFO - [SUBMIT] Submitting task: tablet
2025-10-24 10:28:29,379 - ERROR - [ERROR] API request failed: HTTPSConnectionPool(host='api.dataforseo.com', port=443): Max retries exceeded with url: /v3/merchant/amazon/products/task_post (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x00000268EA87EAD0>: Failed to resolve 'api.dataforseo.com' ([Errno 11001] getaddrinfo failed)"))
2025-10-24 10:28:29,381 - ERROR - [ERROR] Task submission failed: No response
2025-10-24 10:28:31,757 - ERROR - Failed to update stats: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

2025-10-24 10:28:31,779 - ERROR - [FATAL] Fatal error: connection already closed
Traceback (most recent call last):
  File "C:\Users\AFI-02-AI\Desktop\TrendSensei\server_py\dataforseo_cron.py", line 321, in update_stats
    cursor.execute("""
    ~~~~~~~~~~~~~~^^^^
        INSERT INTO collection_stats
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        (total_tasks, total_products, total_cost, keywords_processed)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        VALUES (%s, %s, %s, %s)
        ^^^^^^^^^^^^^^^^^^^^^^^
    """, (tasks, products, cost, ','.join(keywords)))
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\AFI-02-AI\Desktop\TrendSensei\server_py\dataforseo_cron.py", line 676, in main
    result = collector.collect_all(keywords)
  File "C:\Users\AFI-02-AI\Desktop\TrendSensei\server_py\dataforseo_cron.py", line 570, in collect_all
    self.db.update_stats(
    ~~~~~~~~~~~~~~~~~~~~^
        tasks=successful,
        ^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        keywords=keywords
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\AFI-02-AI\Desktop\TrendSensei\server_py\dataforseo_cron.py", line 329, in update_stats
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
psycopg2.InterfaceError: connection already closed
2025-10-24 10:46:23,425 - INFO - [INIT] DataForSEO client initialized
2025-10-24 10:46:23,425 - INFO - 
======================================================================
2025-10-24 10:46:23,426 - INFO - [START] STARTING DATA COLLECTION
2025-10-24 10:46:23,426 - INFO - [INFO] Keywords: laptop
2025-10-24 10:46:23,426 - INFO - [INFO] Started at: 2025-10-24 10:46:23.426501
2025-10-24 10:46:23,426 - INFO - ======================================================================

2025-10-24 10:46:23,426 - INFO - [ATTEMPT 1/3] Connecting to database...
2025-10-24 10:46:33,428 - ERROR - [FAILED] Database connection attempt 1/3: connection to server at "122.176.108.253", port 5432 failed: timeout expired

2025-10-24 10:46:33,428 - INFO - [RETRY] Waiting 2 seconds before retry...
2025-10-24 10:46:35,429 - INFO - [ATTEMPT 2/3] Connecting to database...
2025-10-24 10:46:45,441 - ERROR - [FAILED] Database connection attempt 2/3: connection to server at "122.176.108.253", port 5432 failed: timeout expired

2025-10-24 10:46:45,444 - INFO - [RETRY] Waiting 4 seconds before retry...
2025-10-24 10:46:49,446 - INFO - [ATTEMPT 3/3] Connecting to database...
2025-10-24 10:46:59,453 - ERROR - [FAILED] Database connection attempt 3/3: connection to server at "122.176.108.253", port 5432 failed: timeout expired

2025-10-24 10:46:59,456 - ERROR - [ERROR] All database connection attempts failed
2025-10-24 10:46:59,457 - ERROR - Please check:
2025-10-24 10:46:59,460 - ERROR -   1. Database server is running and accessible
2025-10-24 10:46:59,461 - ERROR -   2. Firewall allows connections on port 5432
2025-10-24 10:46:59,462 - ERROR -   3. Database credentials are correct
2025-10-24 10:46:59,463 - ERROR -   4. Network connectivity to database server
2025-10-24 10:46:59,464 - ERROR - [FATAL] Cannot proceed without database connection
2025-10-24 10:48:41,834 - INFO - [INIT] DataForSEO client initialized
2025-10-24 10:48:41,834 - INFO - 
======================================================================
2025-10-24 10:48:41,834 - INFO - [START] STARTING DATA COLLECTION
2025-10-24 10:48:41,835 - INFO - [INFO] Keywords: laptop
2025-10-24 10:48:41,835 - INFO - [INFO] Started at: 2025-10-24 10:48:41.835368
2025-10-24 10:48:41,835 - INFO - ======================================================================

2025-10-24 10:48:41,835 - INFO - [ATTEMPT 1/3] Connecting to database...
2025-10-24 10:48:45,910 - ERROR - [FAILED] Database connection attempt 1/3: connection to server at "localhost" (::1), port 8000 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 8000 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

2025-10-24 10:48:45,911 - INFO - [RETRY] Waiting 2 seconds before retry...
2025-10-24 10:48:47,912 - INFO - [ATTEMPT 2/3] Connecting to database...
2025-10-24 10:48:51,985 - ERROR - [FAILED] Database connection attempt 2/3: connection to server at "localhost" (::1), port 8000 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 8000 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

2025-10-24 10:48:51,988 - INFO - [RETRY] Waiting 4 seconds before retry...
2025-10-24 10:48:55,989 - INFO - [ATTEMPT 3/3] Connecting to database...
2025-10-24 10:49:00,073 - ERROR - [FAILED] Database connection attempt 3/3: connection to server at "localhost" (::1), port 8000 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 8000 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

2025-10-24 10:49:00,073 - ERROR - [ERROR] All database connection attempts failed
2025-10-24 10:49:00,074 - ERROR - Please check:
2025-10-24 10:49:00,074 - ERROR -   1. Database server is running and accessible
2025-10-24 10:49:00,074 - ERROR -   2. Firewall allows connections on port 5432
2025-10-24 10:49:00,074 - ERROR -   3. Database credentials are correct
2025-10-24 10:49:00,075 - ERROR -   4. Network connectivity to database server
2025-10-24 10:49:00,075 - ERROR - [FATAL] Cannot proceed without database connection
2025-10-24 10:50:06,051 - INFO - [INIT] DataForSEO client initialized
2025-10-24 10:50:06,051 - INFO - 
======================================================================
2025-10-24 10:50:06,051 - INFO - [START] STARTING DATA COLLECTION
2025-10-24 10:50:06,051 - INFO - [INFO] Keywords: laptop
2025-10-24 10:50:06,051 - INFO - [INFO] Started at: 2025-10-24 10:50:06.051918
2025-10-24 10:50:06,052 - INFO - ======================================================================

2025-10-24 10:50:06,052 - INFO - [ATTEMPT 1/3] Connecting to database...
2025-10-24 10:50:16,053 - ERROR - [FAILED] Database connection attempt 1/3: connection to server at "122.176.108.253", port 5432 failed: timeout expired

2025-10-24 10:50:16,062 - INFO - [RETRY] Waiting 2 seconds before retry...
2025-10-24 10:50:18,064 - INFO - [ATTEMPT 2/3] Connecting to database...
2025-10-24 10:50:28,069 - ERROR - [FAILED] Database connection attempt 2/3: connection to server at "122.176.108.253", port 5432 failed: timeout expired

2025-10-24 10:50:28,070 - INFO - [RETRY] Waiting 4 seconds before retry...
2025-10-24 10:50:32,071 - INFO - [ATTEMPT 3/3] Connecting to database...
2025-10-24 10:50:42,073 - ERROR - [FAILED] Database connection attempt 3/3: connection to server at "122.176.108.253", port 5432 failed: timeout expired

2025-10-24 10:50:42,074 - ERROR - [ERROR] All database connection attempts failed
2025-10-24 10:50:42,074 - ERROR - Please check:
2025-10-24 10:50:42,075 - ERROR -   1. Database server is running and accessible
2025-10-24 10:50:42,075 - ERROR -   2. Firewall allows connections on port 5432
2025-10-24 10:50:42,075 - ERROR -   3. Database credentials are correct
2025-10-24 10:50:42,076 - ERROR -   4. Network connectivity to database server
2025-10-24 10:50:42,076 - ERROR - [FATAL] Cannot proceed without database connection
2025-10-24 10:56:03,231 - INFO - [INIT] DataForSEO client initialized
2025-10-24 10:56:03,232 - INFO - 
======================================================================
2025-10-24 10:56:03,232 - INFO - [START] STARTING DATA COLLECTION
2025-10-24 10:56:03,232 - INFO - [INFO] Keywords: laptop
2025-10-24 10:56:03,232 - INFO - [INFO] Started at: 2025-10-24 10:56:03.232466
2025-10-24 10:56:03,232 - INFO - ======================================================================

2025-10-24 10:56:03,232 - INFO - [ATTEMPT 1/3] Connecting to database...
2025-10-24 10:56:13,238 - ERROR - [FAILED] Database connection attempt 1/3: connection to server at "122.176.108.253", port 5432 failed: timeout expired

2025-10-24 10:56:13,238 - INFO - [RETRY] Waiting 2 seconds before retry...
2025-10-24 10:56:15,240 - INFO - [ATTEMPT 2/3] Connecting to database...
2025-10-24 10:56:25,252 - ERROR - [FAILED] Database connection attempt 2/3: connection to server at "122.176.108.253", port 5432 failed: timeout expired

2025-10-24 10:56:25,253 - INFO - [RETRY] Waiting 4 seconds before retry...
2025-10-24 10:56:29,254 - INFO - [ATTEMPT 3/3] Connecting to database...
2025-10-24 10:56:39,266 - ERROR - [FAILED] Database connection attempt 3/3: connection to server at "122.176.108.253", port 5432 failed: timeout expired

2025-10-24 10:56:39,267 - ERROR - [ERROR] All database connection attempts failed
2025-10-24 10:56:39,268 - ERROR - Please check:
2025-10-24 10:56:39,268 - ERROR -   1. Database server is running and accessible
2025-10-24 10:56:39,269 - ERROR -   2. Firewall allows connections on port 5432
2025-10-24 10:56:39,269 - ERROR -   3. Database credentials are correct
2025-10-24 10:56:39,270 - ERROR -   4. Network connectivity to database server
2025-10-24 10:56:39,275 - ERROR - [FATAL] Cannot proceed without database connection
2025-10-24 11:08:22,622 - INFO - [INIT] DataForSEO client initialized
2025-10-24 11:08:22,622 - INFO - 
======================================================================
2025-10-24 11:08:22,622 - INFO - [START] STARTING DATA COLLECTION
2025-10-24 11:08:22,622 - INFO - [INFO] Keywords: laptop
2025-10-24 11:08:22,622 - INFO - [INFO] Started at: 2025-10-24 11:08:22.622947
2025-10-24 11:08:22,623 - INFO - ======================================================================

2025-10-24 11:08:22,623 - INFO - [ATTEMPT 1/3] Connecting to database...
2025-10-24 11:08:22,697 - INFO - [SUCCESS] Database connected
2025-10-24 11:08:22,765 - INFO - [SUCCESS] Database tables ready
2025-10-24 11:08:22,765 - INFO - ======================================================================
2025-10-24 11:08:22,765 - INFO - [START] Collecting: laptop
2025-10-24 11:08:22,766 - INFO - ======================================================================
2025-10-24 11:08:22,766 - INFO - [SUBMIT] Submitting task: laptop
2025-10-24 11:08:22,766 - INFO - [SUBMIT] Location: United States, Language: English (United States)
2025-10-24 11:08:23,580 - ERROR - [ERROR] Task submission failed. Code: 40100, Message: You are not authorized to access this resource. See your login details here: https://app.dataforseo.com/api-access .
2025-10-24 11:08:23,626 - INFO - Database disconnected
2025-10-24 11:08:23,626 - INFO - 
======================================================================
2025-10-24 11:08:23,626 - INFO - [COMPLETE] COLLECTION COMPLETED
2025-10-24 11:08:23,626 - INFO - [STATS] Total keywords: 1
2025-10-24 11:08:23,627 - INFO - [STATS] Successful: 0
2025-10-24 11:08:23,627 - INFO - [STATS] Total products: 0
2025-10-24 11:08:23,627 - INFO - [STATS] Total cost: $0.000
2025-10-24 11:08:23,627 - INFO - [INFO] Completed at: 2025-10-24 11:08:23.627333
2025-10-24 11:08:23,627 - INFO - ======================================================================

2025-10-24 12:49:34,490 - INFO - [INIT] DataForSEO client initialized
2025-10-24 12:49:34,490 - INFO - 
======================================================================
2025-10-24 12:49:34,490 - INFO - [START] STARTING DATA COLLECTION
2025-10-24 12:49:34,490 - INFO - [INFO] Keywords: laptop, smartphone, headphones, smartwatch, tablet
2025-10-24 12:49:34,491 - INFO - [INFO] Started at: 2025-10-24 12:49:34.491024
2025-10-24 12:49:34,491 - INFO - ======================================================================

2025-10-24 12:49:34,491 - INFO - [ATTEMPT 1/3] Connecting to database...
2025-10-24 12:49:34,599 - INFO - [SUCCESS] Database connected
2025-10-24 12:49:34,681 - INFO - [SUCCESS] Database tables ready
2025-10-24 12:49:34,682 - INFO - ======================================================================
2025-10-24 12:49:34,682 - INFO - [START] Collecting: laptop
2025-10-24 12:49:34,682 - INFO - ======================================================================
2025-10-24 12:49:34,682 - INFO - [SUBMIT] Submitting task: laptop
2025-10-24 12:49:34,683 - INFO - [SUBMIT] Location: United States, Language: English (United States)
2025-10-24 12:49:35,266 - INFO - [SUCCESS] Task submitted: 10241019-1177-0209-0000-0d089bc0f43c
2025-10-24 12:49:35,295 - ERROR - [ERROR] Failed to save task: column "location_name" of relation "dataforseo_tasks" does not exist
LINE 3:                 (id, keyword, location_name, language_name, ...
                                      ^

2025-10-24 12:49:35,309 - INFO - [WAIT] Waiting 90 seconds for processing...
2025-10-24 12:51:05,310 - INFO - [FETCH] Fetching results for task: 10241019-1177-0209-0000-0d089bc0f43c
2025-10-24 12:51:05,880 - WARNING - [WAITING] Task not ready: 10241019-1177-0209-0000-0d089bc0f43c (status: 40602)
2025-10-24 12:51:05,880 - INFO - ======================================================================
2025-10-24 12:51:05,881 - INFO - [START] Collecting: smartphone
2025-10-24 12:51:05,881 - INFO - ======================================================================
2025-10-24 12:51:05,881 - INFO - [SUBMIT] Submitting task: smartphone
2025-10-24 12:51:05,881 - INFO - [SUBMIT] Location: United States, Language: English (United States)
2025-10-24 12:51:06,426 - INFO - [SUCCESS] Task submitted: 10241021-1177-0209-0000-3eeaea276bb0
2025-10-24 12:51:06,481 - ERROR - [ERROR] Failed to save task: column "location_name" of relation "dataforseo_tasks" does not exist
LINE 3:                 (id, keyword, location_name, language_name, ...
                                      ^

2025-10-24 12:51:06,495 - INFO - [WAIT] Waiting 90 seconds for processing...
2025-10-24 12:52:36,496 - INFO - [FETCH] Fetching results for task: 10241021-1177-0209-0000-3eeaea276bb0
2025-10-24 12:52:37,026 - WARNING - [WAITING] Task not ready: 10241021-1177-0209-0000-3eeaea276bb0 (status: 40602)
2025-10-24 12:52:37,027 - INFO - ======================================================================
2025-10-24 12:52:37,027 - INFO - [START] Collecting: headphones
2025-10-24 12:52:37,027 - INFO - ======================================================================
2025-10-24 12:52:37,027 - INFO - [SUBMIT] Submitting task: headphones
2025-10-24 12:52:37,028 - INFO - [SUBMIT] Location: United States, Language: English (United States)
2025-10-24 12:52:37,630 - INFO - [SUCCESS] Task submitted: 10241022-1177-0209-0000-15c888e7083c
2025-10-24 12:52:37,665 - ERROR - [ERROR] Failed to save task: column "location_name" of relation "dataforseo_tasks" does not exist
LINE 3:                 (id, keyword, location_name, language_name, ...
                                      ^

2025-10-24 12:52:37,678 - INFO - [WAIT] Waiting 90 seconds for processing...
2025-10-24 12:54:07,679 - INFO - [FETCH] Fetching results for task: 10241022-1177-0209-0000-15c888e7083c
2025-10-24 12:54:08,760 - INFO - [SUCCESS] Results retrieved for task: 10241022-1177-0209-0000-15c888e7083c
2025-10-24 12:54:08,763 - INFO - [EXTRACT] Extracted 74 products
2025-10-24 12:54:08,887 - ERROR - [ERROR] Failed to save products: invalid input syntax for type json
LINE 8: ...es/I/51Dd8aGSW0L._AC_UY218_.jpg',29.95,NULL,'USD','90 days f...
                                                             ^
DETAIL:  Token "days" is invalid.
CONTEXT:  JSON data, line 1: 90 days...

2025-10-24 12:54:08,932 - ERROR - [ERROR] Failed to save task: column "location_name" of relation "dataforseo_tasks" does not exist
LINE 3:                 (id, keyword, location_name, language_name, ...
                                      ^

2025-10-24 12:54:08,946 - INFO - [SUCCESS] Collected 0 products for 'headphones'
2025-10-24 12:54:08,947 - INFO - ======================================================================

2025-10-24 12:54:08,948 - INFO - ======================================================================
2025-10-24 12:54:08,949 - INFO - [START] Collecting: smartwatch
2025-10-24 12:54:08,950 - INFO - ======================================================================
2025-10-24 12:54:08,951 - INFO - [SUBMIT] Submitting task: smartwatch
2025-10-24 12:54:08,952 - INFO - [SUBMIT] Location: United States, Language: English (United States)
2025-10-24 12:54:09,586 - INFO - [SUCCESS] Task submitted: 10241024-1177-0209-0000-218f836419fa
2025-10-24 12:54:09,618 - ERROR - [ERROR] Failed to save task: column "location_name" of relation "dataforseo_tasks" does not exist
LINE 3:                 (id, keyword, location_name, language_name, ...
                                      ^

2025-10-24 12:54:09,633 - INFO - [WAIT] Waiting 90 seconds for processing...
2025-10-24 12:55:39,634 - INFO - [FETCH] Fetching results for task: 10241024-1177-0209-0000-218f836419fa
2025-10-24 12:55:40,947 - INFO - [SUCCESS] Results retrieved for task: 10241024-1177-0209-0000-218f836419fa
2025-10-24 12:55:40,948 - INFO - [EXTRACT] Extracted 135 products
2025-10-24 12:55:41,002 - ERROR - [ERROR] Failed to save products: invalid input syntax for type json
LINE 8: ...es/I/81GF-RiWI2L._AC_UY218_.jpg',59.99,NULL,'USD','Save 20% ...
                                                             ^
DETAIL:  Token "Save" is invalid.
CONTEXT:  JSON data, line 1: Save...

2025-10-24 12:55:41,063 - ERROR - [ERROR] Failed to save task: column "location_name" of relation "dataforseo_tasks" does not exist
LINE 3:                 (id, keyword, location_name, language_name, ...
                                      ^

2025-10-24 12:55:41,079 - INFO - [SUCCESS] Collected 0 products for 'smartwatch'
2025-10-24 12:55:41,080 - INFO - ======================================================================

2025-10-24 12:55:41,080 - INFO - ======================================================================
2025-10-24 12:55:41,080 - INFO - [START] Collecting: tablet
2025-10-24 12:55:41,080 - INFO - ======================================================================
2025-10-24 12:55:41,081 - INFO - [SUBMIT] Submitting task: tablet
2025-10-24 12:55:41,081 - INFO - [SUBMIT] Location: United States, Language: English (United States)
2025-10-24 12:55:41,589 - INFO - [SUCCESS] Task submitted: 10241025-1177-0209-0000-acb08eaa998c
2025-10-24 12:55:41,620 - ERROR - [ERROR] Failed to save task: column "location_name" of relation "dataforseo_tasks" does not exist
LINE 3:                 (id, keyword, location_name, language_name, ...
                                      ^

2025-10-24 12:55:41,634 - INFO - [WAIT] Waiting 90 seconds for processing...
2025-10-24 12:55:49,409 - INFO - 
[STOP] Stopped by user
2025-10-24 13:59:45,260 - INFO - [API] Initialized with 60s timeout
2025-10-24 13:59:45,261 - INFO - [DB] Connecting to database (attempt 1/3)...
2025-10-24 13:59:45,403 - INFO - [DB] Connection successful
2025-10-24 13:59:45,450 - INFO - [DB] Tables verified
2025-10-24 13:59:45,451 - INFO - [COLLECT] Keyword: laptop
2025-10-24 13:59:45,451 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 13:59:45,451 - ERROR - [API] Task submission failed for 'laptop'
2025-10-24 13:59:45,451 - INFO - [COLLECT] Keyword: smartphone
2025-10-24 13:59:45,451 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 13:59:45,451 - ERROR - [API] Task submission failed for 'smartphone'
2025-10-24 13:59:45,452 - INFO - [COLLECT] Keyword: headphones
2025-10-24 13:59:45,452 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 13:59:45,452 - ERROR - [API] Task submission failed for 'headphones'
2025-10-24 13:59:45,452 - INFO - [COLLECT] Keyword: smartwatch
2025-10-24 13:59:45,452 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 13:59:45,452 - ERROR - [API] Task submission failed for 'smartwatch'
2025-10-24 13:59:45,453 - INFO - [COLLECT] Keyword: tablet
2025-10-24 13:59:45,453 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 13:59:45,453 - ERROR - [API] Task submission failed for 'tablet'
2025-10-24 13:59:45,453 - INFO - [DB] Disconnected
2025-10-24 13:59:45,453 - INFO - [COMPLETE] Data collection finished successfully
2025-10-24 14:18:56,294 - INFO - [API] Initialized with 60s timeout
2025-10-24 14:18:56,294 - INFO - [DB] Connecting to database (attempt 1/3)...
2025-10-24 14:18:56,402 - INFO - [DB] Connection successful
2025-10-24 14:18:56,443 - INFO - [DB] Tables verified
2025-10-24 14:18:56,443 - INFO - [COLLECT] Keyword: laptop
2025-10-24 14:18:56,444 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:18:56,444 - ERROR - [API] Task submission failed for 'laptop'
2025-10-24 14:18:56,444 - INFO - [COLLECT] Keyword: smartphone
2025-10-24 14:18:56,444 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:18:56,445 - ERROR - [API] Task submission failed for 'smartphone'
2025-10-24 14:18:56,445 - INFO - [COLLECT] Keyword: headphones
2025-10-24 14:18:56,445 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:18:56,445 - ERROR - [API] Task submission failed for 'headphones'
2025-10-24 14:18:56,446 - INFO - [COLLECT] Keyword: smartwatch
2025-10-24 14:18:56,446 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:18:56,446 - ERROR - [API] Task submission failed for 'smartwatch'
2025-10-24 14:18:56,446 - INFO - [COLLECT] Keyword: tablet
2025-10-24 14:18:56,446 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:18:56,446 - ERROR - [API] Task submission failed for 'tablet'
2025-10-24 14:18:56,447 - INFO - [DB] Disconnected
2025-10-24 14:18:56,447 - INFO - [COMPLETE] Data collection finished successfully
2025-10-24 14:29:03,092 - INFO - [API] Initialized with 60s timeout
2025-10-24 14:29:03,092 - INFO - [DB] Connecting to database (attempt 1/3)...
2025-10-24 14:29:03,183 - INFO - [DB] Connection successful
2025-10-24 14:29:03,227 - INFO - [DB] Tables verified
2025-10-24 14:29:03,228 - INFO - [COLLECT] Keyword: laptop
2025-10-24 14:29:03,228 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:29:03,229 - ERROR - [API] Task submission failed for 'laptop'
2025-10-24 14:29:03,229 - INFO - [COLLECT] Keyword: smartphone
2025-10-24 14:29:03,229 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:29:03,230 - ERROR - [API] Task submission failed for 'smartphone'
2025-10-24 14:29:03,230 - INFO - [COLLECT] Keyword: headphones
2025-10-24 14:29:03,230 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:29:03,230 - ERROR - [API] Task submission failed for 'headphones'
2025-10-24 14:29:03,231 - INFO - [COLLECT] Keyword: smartwatch
2025-10-24 14:29:03,231 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:29:03,231 - ERROR - [API] Task submission failed for 'smartwatch'
2025-10-24 14:29:03,231 - INFO - [COLLECT] Keyword: tablet
2025-10-24 14:29:03,232 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:29:03,232 - ERROR - [API] Task submission failed for 'tablet'
2025-10-24 14:29:03,232 - INFO - [DB] Disconnected
2025-10-24 14:29:03,232 - INFO - [COMPLETE] Data collection finished successfully
2025-10-24 14:30:23,234 - INFO - [API] Initialized with 60s timeout
2025-10-24 14:30:23,235 - INFO - [DB] Connecting to database (attempt 1/3)...
2025-10-24 14:30:23,446 - INFO - [DB] Connection successful
2025-10-24 14:30:23,557 - INFO - [DB] Tables verified
2025-10-24 14:30:23,558 - INFO - [COLLECT] Keyword: laptop
2025-10-24 14:30:23,558 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:30:23,558 - ERROR - [API] Task submission failed for 'laptop'
2025-10-24 14:30:23,559 - INFO - [COLLECT] Keyword: smartphone
2025-10-24 14:30:23,559 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:30:23,559 - ERROR - [API] Task submission failed for 'smartphone'
2025-10-24 14:30:23,560 - INFO - [COLLECT] Keyword: headphones
2025-10-24 14:30:23,560 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:30:23,560 - ERROR - [API] Task submission failed for 'headphones'
2025-10-24 14:30:23,560 - INFO - [COLLECT] Keyword: smartwatch
2025-10-24 14:30:23,560 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:30:23,561 - ERROR - [API] Task submission failed for 'smartwatch'
2025-10-24 14:30:23,561 - INFO - [COLLECT] Keyword: tablet
2025-10-24 14:30:23,561 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:30:23,561 - ERROR - [API] Task submission failed for 'tablet'
2025-10-24 14:30:23,561 - INFO - [DB] Disconnected
2025-10-24 14:30:23,562 - INFO - [COMPLETE] Data collection finished successfully
2025-10-24 14:34:07,858 - INFO - [API] Initialized with 60s timeout
2025-10-24 14:34:07,858 - INFO - [DB] Connecting to database (attempt 1/3)...
2025-10-24 14:34:07,948 - INFO - [DB] Connection successful
2025-10-24 14:34:07,990 - INFO - [DB] Tables verified
2025-10-24 14:34:07,990 - INFO - [COLLECT] Keyword: laptop
2025-10-24 14:34:07,990 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:34:07,991 - ERROR - [API] Task submission failed for 'laptop'
2025-10-24 14:34:07,991 - INFO - [COLLECT] Keyword: smartphone
2025-10-24 14:34:07,991 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:34:07,992 - ERROR - [API] Task submission failed for 'smartphone'
2025-10-24 14:34:07,992 - INFO - [COLLECT] Keyword: headphones
2025-10-24 14:34:07,992 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:34:07,992 - ERROR - [API] Task submission failed for 'headphones'
2025-10-24 14:34:07,993 - INFO - [COLLECT] Keyword: smartwatch
2025-10-24 14:34:07,993 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:34:07,993 - ERROR - [API] Task submission failed for 'smartwatch'
2025-10-24 14:34:07,993 - INFO - [COLLECT] Keyword: tablet
2025-10-24 14:34:07,994 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:34:07,994 - ERROR - [API] Task submission failed for 'tablet'
2025-10-24 14:34:07,994 - INFO - [DB] Disconnected
2025-10-24 14:34:07,994 - INFO - [COMPLETE] Data collection finished successfully
2025-10-24 14:38:51,376 - INFO - [API] Initialized with 60s timeout
2025-10-24 14:38:51,376 - INFO - [DB] Connecting to database (attempt 1/3)...
2025-10-24 14:38:51,449 - INFO - [DB] Connection successful
2025-10-24 14:38:51,491 - INFO - [DB] Tables verified
2025-10-24 14:38:51,492 - INFO - [COLLECT] Keyword: laptop
2025-10-24 14:38:51,492 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:38:51,493 - ERROR - [API] Task submission failed for 'laptop'
2025-10-24 14:38:51,493 - INFO - [COLLECT] Keyword: smartphone
2025-10-24 14:38:51,493 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:38:51,493 - ERROR - [API] Task submission failed for 'smartphone'
2025-10-24 14:38:51,494 - INFO - [COLLECT] Keyword: headphones
2025-10-24 14:38:51,494 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:38:51,494 - ERROR - [API] Task submission failed for 'headphones'
2025-10-24 14:38:51,494 - INFO - [COLLECT] Keyword: smartwatch
2025-10-24 14:38:51,495 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:38:51,495 - ERROR - [API] Task submission failed for 'smartwatch'
2025-10-24 14:38:51,495 - INFO - [COLLECT] Keyword: tablet
2025-10-24 14:38:51,495 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:38:51,495 - ERROR - [API] Task submission failed for 'tablet'
2025-10-24 14:38:51,496 - INFO - [DB] Disconnected
2025-10-24 14:38:51,496 - INFO - [COMPLETE] Data collection finished successfully
2025-10-24 14:44:45,114 - INFO - [API] Initialized with 60s timeout
2025-10-24 14:44:45,114 - INFO - [DB] Connecting to database (attempt 1/3)...
2025-10-24 14:44:45,200 - INFO - [DB] Connection successful
2025-10-24 14:44:45,252 - INFO - [DB] Tables verified
2025-10-24 14:44:45,252 - INFO - [COLLECT] Keyword: laptop
2025-10-24 14:44:45,253 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:44:45,253 - ERROR - [API] Task submission failed for 'laptop'
2025-10-24 14:44:45,253 - INFO - [COLLECT] Keyword: smartphone
2025-10-24 14:44:45,253 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:44:45,254 - ERROR - [API] Task submission failed for 'smartphone'
2025-10-24 14:44:45,254 - INFO - [COLLECT] Keyword: headphones
2025-10-24 14:44:45,254 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:44:45,254 - ERROR - [API] Task submission failed for 'headphones'
2025-10-24 14:44:45,254 - INFO - [COLLECT] Keyword: smartwatch
2025-10-24 14:44:45,254 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:44:45,254 - ERROR - [API] Task submission failed for 'smartwatch'
2025-10-24 14:44:45,254 - INFO - [COLLECT] Keyword: tablet
2025-10-24 14:44:45,255 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:44:45,255 - ERROR - [API] Task submission failed for 'tablet'
2025-10-24 14:44:45,255 - INFO - [DB] Disconnected
2025-10-24 14:44:45,255 - INFO - [COMPLETE] Data collection finished successfully
2025-10-24 14:45:43,107 - INFO - [API] Initialized with 60s timeout
2025-10-24 14:45:43,107 - INFO - [DB] Connecting to database (attempt 1/3)...
2025-10-24 14:45:43,209 - INFO - [DB] Connection successful
2025-10-24 14:45:43,250 - INFO - [DB] Tables verified
2025-10-24 14:45:43,250 - INFO - [COLLECT] Keyword: laptop
2025-10-24 14:45:43,250 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:45:43,251 - ERROR - [API] Task submission failed for 'laptop'
2025-10-24 14:45:43,251 - INFO - [COLLECT] Keyword: smartphone
2025-10-24 14:45:43,251 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:45:43,251 - ERROR - [API] Task submission failed for 'smartphone'
2025-10-24 14:45:43,251 - INFO - [COLLECT] Keyword: headphones
2025-10-24 14:45:43,251 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:45:43,252 - ERROR - [API] Task submission failed for 'headphones'
2025-10-24 14:45:43,252 - INFO - [COLLECT] Keyword: smartwatch
2025-10-24 14:45:43,252 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:45:43,252 - ERROR - [API] Task submission failed for 'smartwatch'
2025-10-24 14:45:43,252 - INFO - [COLLECT] Keyword: tablet
2025-10-24 14:45:43,252 - ERROR - [API ERROR] RestClient.post() got an unexpected keyword argument 'timeout'
2025-10-24 14:45:43,252 - ERROR - [API] Task submission failed for 'tablet'
2025-10-24 14:45:43,253 - INFO - [DB] Disconnected
2025-10-24 14:45:43,253 - INFO - [COMPLETE] Data collection finished successfully
2025-10-24 15:19:32,766 - INFO - [API] Initialized with 60s timeout
2025-10-24 15:19:32,766 - INFO - [DB] Connecting to database (attempt 1/3)...
2025-10-24 15:19:32,859 - INFO - [DB] Connection successful
2025-10-24 15:19:32,898 - INFO - [DB] Tables verified
2025-10-24 15:19:32,899 - INFO - [COLLECT] Keyword: laptop
